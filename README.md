📑 超星学习通考试/测验题目提取助手
v4.5 稳定版 / 已修复乱码 Release: 2025-12-28
📖 项目简介 (Introduction)
超星学习通考试/测验题目提取助手 是一款专为超星学习通（Chaoxing/Xuexitong）平台设计的浏览器用户脚本。

本项目是首个将“完整字体解密算法”与“现代化 UI 交互”及“多格式导出”完美融合的解决方案。
针对近期学习通更新导致的题目乱码（字体加密）问题，本脚本集成了核心的 MD5 哈希截取算法，能够还原 99% 的加密文字，
并提供一键导出 Word 和 TXT 的功能，是期末复习和资料备份的终极工具。

✨ 核心亮点 (Key Features)
1. 独家字体解密技术 (Advanced Decryption)
乱码终结者：不同于市面上普通的提取脚本，本脚本内置了完整的 TTF 字体解析引擎 (Typr.js) 和映射表 (Table.json)。
算法突破：修复了传统脚本在处理新版加密字体时哈希匹配失败的问题（通过 md5(path).slice(24) 精确匹配），彻底解决题目中出现“崤崡”等怪异乱码的情况。
2. 极致的导出体验 (Smart Export)
多格式支持：
📄 Word (.doc)：保留题目格式、选项布局和正确答案的高亮显示，直接打印即可使用。
📝 TXT (.txt)：纯文本格式，方便复制粘贴到手机或即时通讯软件。
智能命名：脚本会自动抓取页面中的章节标题（如
<h3>国际结算第1章</h3>
）作为文件名，告别“新建文本文档.txt”的混乱。
4. 现代化交互界面 (Modern UI)
非侵入式设计：悬浮于页面左侧，不遮挡题目内容。
快捷操作栏：在侧边栏直接提供“⬇️ Word”和“⬇️ TXT”直达按钮，无需打开预览窗口即可秒速下载。
防遮挡机制：拥有最高层级 (z-index)，确保在任何 iframe 嵌套或广告弹窗之上。
🛠️ 安装指南 (Installation)
安装管理器： 确保你的浏览器已安装 Tampermonkey (油猴) 或 ScriptCat (脚本猫) 扩展。
安装脚本： 点击顶部的“点击安装脚本”按钮（或者手动将JS文件拖入浏览器）。
必要的资源权限： 脚本需要加载外部的字体映射库和解密算法库，安装时请允许以下域名的访问权限：
scriptcat.org (用于加载 TyprMd5.js)
forestpolice.org (用于加载 table.json)
🖥️ 使用说明 (User Guide)
进入测验：登录学习通，打开任意一门课程的“章节测验”或“作业”页面。
等待加载：页面加载完成后，左侧会出现 绿色悬浮菜单。
功能选择：
点击 “📑 提取题目”：弹出一个包含所有题目的预览窗口，可全选复制。
点击 “⬇️ Word”：直接下载排版好的 Word 文档。
点击 “⬇️ TXT”：直接下载纯文本文件。
关于乱码：如果页面存在加密字体，脚本会自动在后台静默解密，你导出的内容将是正常的汉字。
🧩 技术细节 (Technical Details)
本脚本的“首创性”在于修复了旧版解密逻辑的缺陷。

旧版逻辑：直接对字形路径进行 MD5 哈希，导致新版字体库无法匹配。
v4.5 新版逻辑：
// 关键修复代码
const path = Typr.U.glyphToPath(currentFontData, glyphIndex);
// 必须截取最后8位才能与映射表匹配
const hash = md5Fn(JSON.stringify(path)).slice(24);
正是这一行关键的 .slice(24)，使得本脚本成为目前市面上解密成功率最高的工具之一。

⚠️ 免责声明 (Disclaimer)
本脚本仅供个人学习、复习和资料整理使用。
严禁将本脚本用于考试作弊、商业牟利或任何违反学校规定的行为。
脚本作者不对使用者因使用本脚本而产生的任何后果负责。
| © 2025
